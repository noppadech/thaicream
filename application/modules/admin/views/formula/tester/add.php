<div class="row">    <div class="col-sm-12 col-md-12">        <?php        echo Modules::run('adminlte/Widget/box_open', '', $style = 'primary', $solid = FALSE);        $attributes = array(            'class' => 'form-horizontal'        );        echo form_open('admin/formula/tester/process/' . $master_id, $attributes);        ?>         <div class="col-md-6">             <div class="input-group">                <label class="input-group-addon" for="formula_name">ชื่อสูตร</label>                <input id="formula_name" name="formula_name" class="form-control" placeholder="ชื่อสูตร" type="text" required="" />            </div>         </div>        <div class="col-md-6">            <div class="form-group">                <label class="col-md-3 control-label" for="formula_remark">หมายเหตุ</label>                <div class="col-md-9">                                         <textarea class="form-control" id="formula_remark" name="formula_remark" placeholder="หมายเหตุ" style="resize: vertical"></textarea>                </div>            </div>        </div>        <fieldset class="col-md-12">            <legend>สูตรการผลิต</legend>             <div class="row path_formula">                <div class="col-md-6">                      <div class="input-group">                        <label class="input-group-addon" for="path_name">PATH NAME</label>                        <input id="path_name" name="path_name[0]" class="form-control" placeholdesr="placeholder" type="text" required="">                    </div>                </div>                <div class="col-md-12">                       <table id="table_matrials_0" class="table table-bordered">                        <thead>                            <tr>                                <th class="text-center" style="width: 50px;">Action</th>                                <th>รหัส | ชื่อวัตถุดิบ</th>                                <th class="text-center"  style="width: 150px;">%</th>                            </tr>                        </thead>                        <tbody>                            <tr>                                <td class="text-center">-</td>                                <td>                                     <select name="path_materials_code[0][]" onchange="set_value(this);" class="form-control select2" style="width: 100%;">                                        <?php                                        foreach ($materials as $key => $value) {                                            ?>                                            <option value="<?php echo $value->id; ?>">                                                <?php echo $value->material_code." | ".$value->material_trade_name." | ".$value->material_trade_name_2;?>                                            </option>                                            <?php                                        }                                        ?>                                    </select>                                 </td>                                <td>                                    <input type="text" name="path_materials_quantity[0][]" onkeyup="calculate_formula()" class="form-control" />                                </td>                            </tr>                        </tbody>                        <tfoot>                            <tr>                                                            </tr>                            <tr>                                <td colspan="4">                                     <button type="button" class="btn btn-primary pull-left" onclick="add_materials(0)"> + วัตถุดิบ</button>                                 </td>                            </tr>                        </tfoot>                    </table>                </div>            </div>            <hr/>             <div class="row">                 <div class="col-md-12 text-right">                      รวมสุทธิ : <span id="sumary"></span>                </div>            </div>            <div class="row">                 <div class="col-md-12">                      <button type="button" class="btn btn-primary pull-left" onclick="add_path();"> + ขั้นตอน</button>                    <button type="button" style="margin-left: 5px;" class="btn btn-danger pull-left" onclick="remove_path();"> - ขั้นตอน</button>                    <button type="button" style="margin-left: 5px;" class="btn btn-warning pull-right" onclick="history.back();">ย้อนกลับ</button>                    <button type="reset" style="margin-left: 5px;" class="btn btn-danger pull-right">ยกเลิก</button>                    <button type="submit" style="margin-left: 5px;" class="btn btn-success pull-right" disabled="">บันทึกข้อมูล</button>                </div>            </div>        </fieldset>        <?php        echo form_close();        echo Modules::run('adminlte/Widget/box_close');        ?>     </div> </div> <link rel="stylesheet" href="<?php echo base_url('assets/dist/admin/select2/select2.css?v=' . date('ymdhis')); ?>"><script type="text/javascript" src="<?php echo base_url('assets/dist/admin/select2/select2.full.min.js'); ?>"></script><script type="text/javascript" src="<?php echo base_url('assets/dist/admin/mustache-master/mustache.min.js'); ?>"></script><script type="text/javascript">    $(function () {        $(".select2").select2();    });    function calculate_formula(){        console.log('test calculate');        var qty = $('input[name^=path_materials_quantity]');        var summary = 0;        $.each(qty,function(index,value){            //console.log(index + " : " + $(value).val());            summary+=parseFloat($(value).val())        });		if(summary.toFixed(4) === "100.0000"){  			$('button[type^=submit]').removeAttr("disabled");        		}else{//			$('button[type^=submit]').attr("disabled","disabled"); 			$('button[type^=submit]').removeAttr("disabled"); 		}         $('#sumary').html(summary.toFixed(4));    }    function add_path() {        var path_count = $('.path_formula').length;        var template = $('#template').html();        var rendered = Mustache.render(template, {path_count: path_count});        $('.path_formula').last().after(rendered+"<script>$(function () {$('.select2').select2();});<\/script>");    }    function remove_path() {        if ($('.path_formula').length > 1) {            $('.path_formula').last().remove();        }    }    function add_materials(id) {        var d = new Date();        var n = d.getTime();        var template = $('#template_materials').html();        var rendered = Mustache.render(template, {auto_id: id,id_remove:n});        $('#table_matrials_' + id + ' tbody > tr').last().after(rendered+"<script>$(function () {$('.select2').select2();});<\/script>");    }       function remove_materials(id) {        $('#material_details_' + id).remove();    }</script><script id="template" type="x-tmpl-mustache"><div class="row path_formula">    <div class="col-md-6">          <div class="input-group">            <label class="input-group-addon" for="path_name_{{path_count}}">PATH NAME</label>            <input id="path_name_{{path_count}}" name="path_name[{{path_count}}]" class="form-control" placeholder="placeholder" type="text" required="">        </div>    </div>    <div class="col-md-12">           <table id="table_matrials_{{path_count}}" class="table table-bordered">            <thead>                <tr>                    <th class="text-center" style="width: 50px;">Action</th>                    <th>รหัส | ชื่อวัตถุดิบ</th>                    <th class="text-center"  style="width: 150px;">%</th>                </tr>            </thead>            <tbody>                <tr>                    <td class="text-center">-</td>                    <td>                         <select name="path_materials_code[{{path_count}}][]" class="form-control select2" style="width: 100%;">                            <?php                            foreach ($materials as $key => $value) {                                ?>                                <option value="<?php echo $value->id; ?>">                                    <?php                                    echo $value->material_code." | ".$value->material_trade_name." | ".$value->material_trade_name_2;                                    ?>                                </option>                                <?php                            }                            ?>                        </select>                     </td>                    <td>                        <input type="text" name="path_materials_quantity[{{path_count}}][]" onkeyup="calculate_formula()" class="form-control" />                    </td>                </tr>            </tbody>            <tfoot>                <tr>                    <td colspan="4">                         <button type="button" class="btn btn-primary pull-left" onclick="add_materials({{path_count}})"> + วัตถุดิบ</button>                     </td>                </tr>            </tfoot>        </table>    </div> </div></script><script id="template_materials" type="x-tmpl-mustache">    <tr id="material_details_{{id_remove}}">        <td class="text-center">            <button type="button" class="btn btn-danger" onclick="remove_materials({{id_remove}});">ลบ</button>        </td>        <td>            <select name="path_materials_code[{{auto_id}}][]" class="form-control select2" style="width: 100%;">                    <?php                    foreach ($materials as $key => $value) {                    ?>                    <option value="<?php echo $value->id; ?>"><?php echo $value->material_code." | ".$value->material_trade_name." | ".$value->material_trade_name_2; ?></option>                    <?php                    }                    ?>                          </select>         </td>        <td>            <input type="text" name="path_materials_quantity[{{auto_id}}][]" onkeyup="calculate_formula()" class="form-control" />        </td>    </tr> </script>